# 喜樂影城訂票助手

一個 Chrome 瀏覽器擴充功能，協助使用者快速且便利地訂購喜樂影城的電影票。

---

<div align="center">

# ⚠️⚠️⚠️ 重要警告 ⚠️⚠️⚠️

## 🚨 使用前請務必閱讀以下限制說明

</div>

> ### ⚠️ **使用者須提前登入**
> 
> - 使用本擴充功能前，**必須先登入喜樂影城網站**
> - 擴充功能需要有效的 `ASP.NET_SessionId` cookie 才能正常運作
> - **未登入或 cookie 過期將導致功能無法使用**
> - 請在開啟擴充功能前，先前往喜樂影城網站完成登入
> - **每個影城似乎都須獨立登入**，請確保已對欲訂票的影城進行過登入行為

---

## 📋 專案簡介

本專案是一個 Chrome Extension（Manifest V3），提供簡潔的彈出視窗介面，讓使用者能夠快速選擇電影、場次、票種和數量，並自動完成訂票流程。擴充功能會自動處理座位選擇，優先選擇相鄰座位，提升使用者體驗。

## ✨ 功能特色

- 🏢 **影城選擇**：支援多間影城（今日影城、南港影城、永和比漾、桃園A19、高雄總圖），切換後自動載入該影城電影列表
- 🎬 **電影選擇**：快速選擇想觀看的電影
- ⏰ **場次查詢**：自動載入並顯示可用的場次時間
- 🎫 **票種選擇**：選填關鍵字輸入框，可指定票種或由系統依優先順序自動選擇（全票 → 單人套票等）
- 🔢 **數量選擇**：可選擇 1-4 張票
- 🪑 **智慧座位選擇**：自動選擇可用座位，多張票時優先選擇相鄰座位
- 🔄 **自動訂票**：一鍵完成整個訂票流程
- 📊 **狀態顯示**：即時顯示 API 呼叫狀態和錯誤訊息

## 🚀 安裝方式

### 從原始碼安裝

1. 下載或複製此專案到本地
2. 開啟 Chrome 瀏覽器
3. 前往 `chrome://extensions/`
4. 開啟右上角的「開發人員模式」
5. 點擊「載入未封裝項目」
6. 選擇專案資料夾
7. 擴充功能即安裝完成

### 注意事項

- 需要 Chrome 瀏覽器（或基於 Chromium 的瀏覽器）
- 需要允許擴充功能存取 `https://ticket.centuryasia.com.tw/*` 網域
- 使用前請先登入喜樂影城網站，確保有有效的 `ASP.NET_SessionId` cookie

## 📖 使用方法

1. **開啟擴充功能**
   - 點擊瀏覽器工具列上的擴充功能圖示
   - 或前往 `chrome://extensions/` 找到「喜樂影城訂票助手」並點擊圖示

2. **選擇影城**
   - 在彈出視窗最上方的「影城」下拉選單選擇要訂票的影城（預設為今日影城）
   - 切換影城後會自動重新載入該影城的電影列表

3. **選擇電影**
   - 在下拉選單中選擇想觀看的電影

4. **選擇場次**
   - 選擇電影後，系統會自動載入可用場次
   - 如果場次未更新，可點擊「重新整理」按鈕

5. **選擇票種和數量**
   - 可選填票種關鍵字（如：全票、學生）；不填則由系統依優先順序自動選擇
   - 選擇需要的票數（1-4 張）

6. **完成訂票**
   - 點擊「訂票」按鈕
   - 擴充功能會自動開啟訂票頁面並完成訂票流程
   - 包括自動選擇座位、確認訂票等步驟

7. **查看狀態**
   - 在「API 狀態」區域可查看即時的 API 呼叫狀態
   - 如有錯誤會顯示詳細的錯誤訊息

## 🛠️ 技術架構

### 技術棧

- **前端技術**
  - HTML5（popup.html）
  - CSS3（樣式設計）
  - JavaScript（功能實作）

- **Chrome Extension API**
  - Manifest V3
  - `chrome.cookies` - 取得網站 cookie
  - `chrome.tabs` - 管理瀏覽器分頁
  - `chrome.scripting` - 注入腳本到網頁

### 專案結構

```
Centuryasia/
├── manifest.json          # 擴充功能設定檔
├── popup.html            # 彈出視窗介面
├── popup.js              # 主要功能邏輯
├── openspec/             # 專案規格文件
│   ├── project.md        # 專案說明
│   └── specs/            # 功能規格
└── README.md             # 本文件
```

### 核心功能模組

- **Cookie 管理**：自動取得並使用 `ASP.NET_SessionId` cookie
- **API 呼叫**：與喜樂影城網站 API 互動，取得電影和場次資訊
- **HTML 解析**：解析網頁 HTML 結構，提取電影、場次、座位等資訊
- **智慧座位選擇**：根據座位位置和相鄰關係，智慧選擇最佳座位組合
- **自動化流程**：自動完成選座、確認等訂票步驟

## 🔧 開發說明

### 開發環境需求

- Chrome 瀏覽器（最新版本）
- 文字編輯器或 IDE（建議使用 VS Code）
- Git（版本控制）

### 程式碼規範

- **命名慣例**
  - 變數和函數：`camelCase`
  - 常數：`UPPER_SNAKE_CASE`
  - HTML/CSS：`kebab-case`

- **格式化**
  - 建議使用 Prettier 進行程式碼格式化
  - 縮排：2 空格
  - 行長限制：100 字元

### 測試

1. **手動測試**
   - 在 Chrome 中載入擴充功能
   - 測試各個功能流程
   - 檢查錯誤處理

2. **除錯**
   - 使用 Chrome DevTools 檢查 popup 視窗
   - 查看 Console 輸出
   - 檢查 Network 請求

## ⚠️ 注意事項

- **網站結構變更**：喜樂影城網站結構如有變更，可能需要更新程式碼
- **Cookie 有效性**：需要有效的 `ASP.NET_SessionId` cookie，請確保已登入網站
- **權限要求**：擴充功能需要存取 cookies、tabs 和 scripting 權限
- **瀏覽器相容性**：僅支援 Chrome 或基於 Chromium 的瀏覽器

## 📝 授權資訊

本專案僅供學習和研究使用。使用時請遵守喜樂影城網站的使用條款。

## 🤝 貢獻

歡迎提交 Issue 或 Pull Request 來改善此專案。

## 📧 聯絡方式

如有問題或建議，請透過 GitHub Issues 提出。

---

**免責聲明**：本擴充功能為第三方開發，與喜樂影城官方無關。使用本擴充功能時請自行承擔風險。
